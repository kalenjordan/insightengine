{% extends 'manage/_base.html.twig' %}

{% block title %}Manage Tags | InsightEngine{% endblock %}

{% block content %}
    <div class="hero border-bottom">
        <div class="hero-titles">
            <h2 class="hero-tagline">
                Manage Tags
            </h2>
        </div>
    </div>

    <div class="marketing manage-tags marketing-last">
        <p>
            Below is a list of all of your tags in Mandrill, sorted by most active.
            If tags are detected to not be active currently, they will be toggled off,
            but you can override that manually.  This data is refreshed daily, but you
            can also <a href="#">manually refresh it</a>.
        </p>
        <h2>Recent</h2>
        <div class="pure-g">
            {% for tag in tags_recent %}
                <div class="tag tag-enabled pure-u-1 pure-u-md-1-2">
                    <div class="tag-inner ">
                        <div class="switch">
                            <input id="cmn-toggle-{{ tag.tag_id }}" class="cmn-toggle cmn-toggle-round" type="checkbox" checked="checked">
                            <label for="cmn-toggle-{{ tag.tag_id }}"></label>
                        </div>
                        <div class="signals">
                            {% if tag.send_count_30_days > 10 %}
                                {% if tag.biggest_gap_last_30_days and tag.last_sent %}
                                    <div class="biggest-gap good "><i class="fa fa-signal"></i>
                                        {{ tag_model.formatBiggestGap(tag.biggest_gap_last_30_days) }}
                                    </div>
                                    <div class="last-sent {{ tag_model.lastSentStatus(tag) }}"><i class="fa fa-calendar"> {{ tag_model.formatLastSent(tag.last_sent) }}</i></div>
                                {% endif %}
                            {% else %}
                                Not enough data
                            {% endif %}
                        </div>
                        <div class="description">
                            <div class="tag-title tooltip" title="{{ tag.tag }}">{{ tag.tag }}</div>
                            <div class="tag-subject">{{ tag.tag_subject ? tag.tag_subject : "No subject found" }}</div>

                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

        <h2>Not sent in 30 days</h2>
        <div class="pure-g">
            {% for tag in tags_old %}
                <div class="tag tag-enabled pure-u-1 pure-u-md-1-2">
                    <div class="tag-inner ">
                        <div class="switch">
                            <input id="cmn-toggle-{{ tag.tag_id }}" class="cmn-toggle cmn-toggle-round" type="checkbox" >
                            <label for="cmn-toggle-{{ tag.tag_id }}"></label>
                        </div>
                        <div class="signals">
                            {% if tag.biggest_gap_last_30_days and tag.last_sent %}
                                <div class="biggest-gap good "><i class="fa fa-signal"></i>
                                    {{ tag_model.formatBiggestGap(tag.biggest_gap_last_30_days) }}
                                </div>
                                <div class="last-sent {{ tag_model.lastSentStatus(tag) }}"><i class="fa fa-calendar"> {{ tag_model.formatLastSent(tag.last_sent) }}</i></div>
                            {% endif %}
                        </div>
                        <div class="description">
                            <div class="tag-title tooltip" title="{{ tag.tag }}">{{ tag.tag }}</div>
                            <div class="tag-subject">{{ tag.tag_subject }}</div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}
